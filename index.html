<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="/vite.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Survival Arena</title>
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700;900&display=swap" rel="stylesheet">
</head>

<body>
  <div class="main-layout">
    <!-- Game Area -->
    <div id="game-container">
      <canvas id="gameCanvas"></canvas>

      <!-- HUD -->
      <div id="hud" class="hidden">
        <!-- Top Bar -->
        <div class="hud-top" style="justify-content: space-between; gap: 0.5rem; width: 100%;">

          <!-- 1. VAGUE -->
          <div class="hud-item wave-item">
            <span class="label">VAGUE</span>
            <div><span id="waveValue" style="font-size: 1.5rem; font-weight: bold; color: #ff3e3e;">1</span></div>
          </div>

          <!-- 2. TOTAL TUÉS -->
          <div class="hud-item">
            <span class="label">TOTAL TUÉS</span>
            <span id="sessionKillsValue">0</span>
          </div>

          <!-- 3. PROGRESSION -->
          <div class="hud-item">
            <span class="label">PROGRESSION</span>
            <div><span id="killsValue">0</span> / <span id="totalEnemiesValue">0</span></div>
          </div>

          <!-- 4. NIVEAU (Reduced width) -->
          <div class="xp-container" style="width: 80px; flex-direction: column;">
            <div class="xp-bar-bg" style="width: 100%;">
              <div id="xpBarFill" class="xp-bar-fill"></div>
            </div>
            <div class="xp-text" style="font-size: 0.7rem; margin-top: 2px;">NIV. <span id="levelValue">1</span></div>
          </div>

          <!-- 5. BESTIAIRE (Renamed) -->
          <button id="monsterListBtn" class="hud-btn" style="font-size: 0.6rem; padding: 0.3rem 0.6rem;">
            LISTE ET DÉFINITION DES ENNEMIES
          </button>

          <!-- 6. PSEUDO -->
          <div id="profile-display" class="hud-item profile-item">
            <span id="playerPseudo">INVITÉ</span>
          </div>

          <!-- 7. OR -->
          <div class="hud-item gold-item">
            <span class="label">OR</span>
            <span id="goldValue">0</span>
          </div>

          <!-- 8. SHOP (Renamed) -->
          <button id="ingameShopBtn" class="hud-btn">
            AMÉLIORATION
          </button>
        </div>
      </div>

      <!-- Login Screen -->
      <div id="login-screen" class="screen">
        <h1 class="title">SURVIVAL <span class="highlight">ARENA</span></h1>
        <div class="login-container">
          <h2>IDENTIFICATION</h2>
          <div class="input-group">
            <input type="text" id="loginPseudo" placeholder="PSEUDO (MAX 12)" maxlength="12"
              style="text-transform:uppercase;">
          </div>

          <div id="pin-section" class="hidden">
            <p id="pin-instruction">Entrez votre code PIN (4 chiffres)</p>
            <input type="password" id="loginPin" placeholder="PIN" maxlength="4">
            <div id="pin-confirm-section" class="hidden">
              <input type="password" id="loginPinConfirm" placeholder="CONFIRMER PIN" maxlength="4">
            </div>
          </div>

          <p id="login-error" class="error-msg"></p>
          <button id="loginBtn" class="primary-btn">CONNEXION</button>
          <div style="margin-top:20px; color:#444; font-size:0.75rem; font-weight:bold;">v1.7.4 - UI & Lag Fix</div>
        </div>
      </div>

      <!-- Profile Modal -->
      <div id="profile-modal" class="screen hidden">
        <h2>PROFIL COMPTE</h2>
        <div class="profile-content">
          <div class="profile-stats">
            <h3>PSEUDO: <span id="profileName" class="highlight"></span></h3>
            <p>Meilleur Score (Kills): <span id="profileBestScore">0</span></p>
            <p>Total Parties: <span id="profileTotalGames">0</span></p>
          </div>

          <div class="history-section">
            <h3>HISTORIQUE (10 DERNIÈRES)</h3>
            <ul id="matchHistoryList" class="ranking-list">
              <!-- Populated by JS -->
            </ul>
          </div>
        </div>
        <button id="closeProfileBtn" class="primary-btn">FERMER</button>
      </div>

      <!-- Monster List Modal -->
      <div id="monster-list-modal" class="screen hidden">
        <h2>BESTIAIRE</h2>
        <div id="monster-grid" class="monster-grid"></div>
        <button id="closeMonsterListBtn" class="primary-btn">FERMER</button>
      </div>

      <!-- All Rankings Modal -->
      <div id="all-rankings-modal" class="screen hidden">
        <h2>CLASSEMENTS MONDIAUX</h2>
        <div class="rankings-grid-container">
          <div class="rank-col">
            <h3>TOP TUEURS (SCORE)</h3>
            <ul id="rank-modal-best" class="ranking-list"></ul>
          </div>
          <div class="rank-col">
            <h3>LÉGENDES (TOTAL KILLS)</h3>
            <ul id="rank-modal-total" class="ranking-list"></ul>
          </div>
          <div class="rank-col">
            <h3>SURVIVANTS (VAGUE)</h3>
            <ul id="rank-modal-wave" class="ranking-list"></ul>
          </div>
          <div class="rank-col">
            <h3>DERNIÈRES PARTIES</h3>
            <ul id="rank-modal-history" class="ranking-list"></ul>
          </div>
        </div>
        <button id="closeAllRankingsBtn" class="primary-btn">FERMER</button>
      </div>

      <!-- Countdown Overlay -->
      <div id="countdown-overlay" class="overlay hidden">
        <div class="countdown-number" id="countdownValue">3</div>
      </div>

      <!-- Start Screen (After Login) -->
      <div id="start-screen" class="screen hidden">
        <h1 class="title">SURVIVAL <span class="highlight">ARENA</span></h1>

        <div class="controls-info">
          <div class="control-group">
            <h3>DÉPLACEMENT</h3>
            <p>ZQSD / FLÈCHES</p>
          </div>
          <div class="control-group">
            <h3>ACTION</h3>
            <p>SHIFT : DASH</p>
          </div>
          <div class="control-group">
            <h3>MARCHÉ</h3>
            <p>ESPACE</p>
          </div>
        </div>

        <div class="start-options">
          <div class="option-block">
            <button id="startBtn" class="primary-btn">NOUVELLE PARTIE</button>
            <p class="option-desc">Départ vague 1. Progression classique.</p>
          </div>
          <div class="option-block" id="continueBlock">
            <button id="continueBtn" class="primary-btn secondary-btn">REPRENDRE (VAGUE <span
                id="bestWaveVal">1</span>)</button>
            <p class="option-desc">Départ vague record. <span class="warning">⚠️ 0 Or, 0 Améliorations, 0 Score.</span>
            </p>
          </div>
        </div>
      </div>

      <!-- Shop Screen -->
      <div id="shop-screen" class="screen hidden">
        <h2 class="screen-title">MARCHÉ</h2>
        <div class="stats-summary">
          <span>OR: <b id="shopGold">0</b></span>
        </div>

        <div class="upgrades-grid" id="upgradesGrid">
          <!-- Upgrades injected via JS -->
        </div>

        <button id="nextWaveBtn" class="primary-btn">VAGUE SUIVANTE</button>
      </div>

      <!-- Game Over Screen -->
      <div id="game-over-screen" class="screen hidden">
        <h1 class="game-over-title">GAME OVER</h1>
        <div class="final-stats">
          <p class="final-stat-big"><span id="finalKills">0</span> VICTIMES</p>
        </div>
        <div class="start-options">
          <div class="option-block">
            <button id="restartBtn" class="primary-btn">REJOUER (VAGUE 1)</button>
          </div>
          <div class="option-block" id="restartContinueBlock">
            <button id="restartContinueBtn" class="primary-btn secondary-btn">REJOUER (VAGUE <span
                id="bestWaveValOver">1</span>)</button>
            <p class="option-desc" style="font-size:0.7rem; margin-top:5px;">Mode Difficile: 0 Or/Stuff</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Sidebar -->
    <aside class="game-info-panel">
      <!-- Top Half: Rankings -->
      <div id="ranking-container">
        <div class="ranking-header">
          <h2>CLASSEMENT</h2>
        </div>

        <div class="ranking-content">
          <div class="ranking-section">
            <h3>TOP TUEURS (PARTIE)</h3>
            <ul class="ranking-list" id="rank-game-sidebar">
              <li style="color:#555; text-align:center; font-style:italic;">Chargement...</li>
            </ul>
          </div>
          <button id="showAllRankingsBtn" class="hud-btn"
            style="width:100%; margin-top:10px; justify-content:center;">VOIR TOUT</button>
        </div>
      </div>

      <!-- Bottom Half: Chat -->
      <div id="chat-container">
        <div class="chat-header">
          <h2>DISCUSSSION</h2>
        </div>
        <div id="chat-messages" class="chat-messages">
          <!-- Messages will appear here -->
          <div class="chat-msg system">Bienvenue dans l'arène !</div>
        </div>
        <div class="chat-input-area">
          <input type="text" id="chatInput" placeholder="Message (max 100 car.)" maxlength="100">
          <button id="chatSendBtn">Envoyer</button>
        </div>
      </div>
    </aside>
    </aside>
  </div>

  <!-- Scrolling Footer -->
  <div class="scrolling-footer">
    <div class="scrolling-content">Ce jeu vous est proposé par Kevin Couëdro • Ce jeu vous est proposé par Kevin Couëdro
      • Ce jeu vous est proposé par Kevin Couëdro •</div>
  </div>

  <script type="module" src="/src/main.js"></script>
</body>

</html>